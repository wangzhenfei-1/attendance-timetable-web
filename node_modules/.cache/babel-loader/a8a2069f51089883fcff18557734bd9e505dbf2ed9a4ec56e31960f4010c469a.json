{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useTimetable.ts\nimport { useState, useEffect } from 'react';\nexport function useTimetable() {\n  _s();\n  // 1) 首 次 渲 染 时，从 localStorage 读 \n  const [lessons, setLessons] = useState(() => {\n    try {\n      const raw = localStorage.getItem('timetable');\n      return raw ? JSON.parse(raw) : [];\n    } catch {\n      return [];\n    }\n  });\n\n  // 2) lessons 变更时写回 localStorage\n  useEffect(() => {\n    localStorage.setItem('timetable', JSON.stringify(lessons));\n  }, [lessons]);\n  const addLesson = lesson => setLessons(prev => [...prev, lesson]);\n  const updateLesson = updated => setLessons(prev => prev.map(l => l.id === updated.id ? updated : l));\n  const removeLesson = id => setLessons(prev => prev.filter(l => l.id !== id));\n  const getIndicatorColor = lesson => {\n    const ratio = lesson.absences / lesson.required;\n    if (ratio <= 1 / 3) return 'green';\n    if (ratio <= 2 / 3) return 'orange';\n    if (ratio < 1) return 'red';\n    return 'black';\n  };\n  return {\n    lessons,\n    addLesson,\n    updateLesson,\n    removeLesson,\n    getIndicatorColor\n  };\n}\n_s(useTimetable, \"wlXXpSeuzttgm8431+i6P4F9kBo=\");","map":{"version":3,"names":["useState","useEffect","useTimetable","_s","lessons","setLessons","raw","localStorage","getItem","JSON","parse","setItem","stringify","addLesson","lesson","prev","updateLesson","updated","map","l","id","removeLesson","filter","getIndicatorColor","ratio","absences","required"],"sources":["/Users/wangzhenfei/Projects/attendance-timetable-web/src/hooks/useTimetable.ts"],"sourcesContent":["// src/hooks/useTimetable.ts\nimport { useState, useEffect } from 'react';\n\nexport type Lesson = {\n  id: string;\n  weekday: 0 | 1 | 2 | 3 | 4;      // 月～金\n  period: 1 | 2 | 3 | 4 | 5 | 6;    // 1限～6限\n  title: string;                   // 科目名\n  professor: string;               // 教授名\n  room: string;                    // 教室\n  required: number;                // 必要出席回数\n  color: string;                   // 背景色\n  absences: number;                // 欠席回数\n};\n\nexport function useTimetable() {\n  // 1) 首 次 渲 染 时，从 localStorage 读 \n  const [lessons, setLessons] = useState<Lesson[]>(() => {\n    try {\n      const raw = localStorage.getItem('timetable');\n      return raw ? JSON.parse(raw) : [];\n    } catch {\n      return [];\n    }\n  });\n\n  // 2) lessons 变更时写回 localStorage\n  useEffect(() => {\n    localStorage.setItem('timetable', JSON.stringify(lessons));\n  }, [lessons]);\n\n  const addLesson = (lesson: Lesson) =>\n    setLessons(prev => [...prev, lesson]);\n\n  const updateLesson = (updated: Lesson) =>\n    setLessons(prev => prev.map(l => l.id === updated.id ? updated : l));\n\n  const removeLesson = (id: string) =>\n    setLessons(prev => prev.filter(l => l.id !== id));\n\n  const getIndicatorColor = (lesson: Lesson) => {\n    const ratio = lesson.absences / lesson.required;\n    if (ratio <= 1/3)    return 'green';\n    if (ratio <= 2/3)    return 'orange';\n    if (ratio < 1)       return 'red';\n    return 'black';\n  };\n\n  return {\n    lessons,\n    addLesson,\n    updateLesson,\n    removeLesson,\n    getIndicatorColor,\n  };\n}\n"],"mappings":";AAAA;AACA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAc3C,OAAO,SAASC,YAAYA,CAAA,EAAG;EAAAC,EAAA;EAC7B;EACA,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGL,QAAQ,CAAW,MAAM;IACrD,IAAI;MACF,MAAMM,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;MAC7C,OAAOF,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAC,GAAG,EAAE;IACnC,CAAC,CAAC,MAAM;MACN,OAAO,EAAE;IACX;EACF,CAAC,CAAC;;EAEF;EACAL,SAAS,CAAC,MAAM;IACdM,YAAY,CAACI,OAAO,CAAC,WAAW,EAAEF,IAAI,CAACG,SAAS,CAACR,OAAO,CAAC,CAAC;EAC5D,CAAC,EAAE,CAACA,OAAO,CAAC,CAAC;EAEb,MAAMS,SAAS,GAAIC,MAAc,IAC/BT,UAAU,CAACU,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAED,MAAM,CAAC,CAAC;EAEvC,MAAME,YAAY,GAAIC,OAAe,IACnCZ,UAAU,CAACU,IAAI,IAAIA,IAAI,CAACG,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKH,OAAO,CAACG,EAAE,GAAGH,OAAO,GAAGE,CAAC,CAAC,CAAC;EAEtE,MAAME,YAAY,GAAID,EAAU,IAC9Bf,UAAU,CAACU,IAAI,IAAIA,IAAI,CAACO,MAAM,CAACH,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKA,EAAE,CAAC,CAAC;EAEnD,MAAMG,iBAAiB,GAAIT,MAAc,IAAK;IAC5C,MAAMU,KAAK,GAAGV,MAAM,CAACW,QAAQ,GAAGX,MAAM,CAACY,QAAQ;IAC/C,IAAIF,KAAK,IAAI,CAAC,GAAC,CAAC,EAAK,OAAO,OAAO;IACnC,IAAIA,KAAK,IAAI,CAAC,GAAC,CAAC,EAAK,OAAO,QAAQ;IACpC,IAAIA,KAAK,GAAG,CAAC,EAAQ,OAAO,KAAK;IACjC,OAAO,OAAO;EAChB,CAAC;EAED,OAAO;IACLpB,OAAO;IACPS,SAAS;IACTG,YAAY;IACZK,YAAY;IACZE;EACF,CAAC;AACH;AAACpB,EAAA,CAxCeD,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}