{"ast":null,"code":"var _jsxFileName = \"/Users/wangzhenfei/Projects/attendance-timetable-web/src/App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useTimetable } from './hooks/useTimetable';\nimport { SemesterSelector } from './components/SemesterSelector';\nimport { TimetableGrid } from './components/TimetableGrid';\nimport { LessonFormModal } from './components/LessonFormModal';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  // 学期持久化：从 localStorage 初始化，并在变更时写回\n  const [semester, setSemester] = useState(() => {\n    const saved = localStorage.getItem('selectedSemester');\n    return saved || '2025 前期';\n  });\n  useEffect(() => {\n    localStorage.setItem('selectedSemester', semester);\n  }, [semester]);\n\n  // 将当前学期传给 Hook，按学期加载/保存课程\n  const {\n    lessons,\n    addLesson,\n    updateLesson,\n    removeLesson,\n    getIndicatorColor\n  } = useTimetable(semester);\n\n  // 弹窗相关状态\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editLesson, setEditLesson] = useState(null);\n  const [newLocation, setNewLocation] = useState(null);\n\n  // 点击空白格子：打开“新增课程”弹窗\n  const openModalAt = (weekday, period) => {\n    setEditLesson(null);\n    setNewLocation({\n      weekday,\n      period\n    });\n    setIsModalOpen(true);\n  };\n\n  // 点击已有课程：打开“编辑课程”弹窗\n  const openModalForEdit = lesson => {\n    setNewLocation(null);\n    setEditLesson(lesson);\n    setIsModalOpen(true);\n  };\n\n  // 弹窗提交后的处理：新增或更新\n  const handleAddOrUpdate = lesson => {\n    if (editLesson) {\n      updateLesson(lesson);\n    } else {\n      addLesson(lesson);\n    }\n    setIsModalOpen(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\u6642\\u9593\\u5272\\uFF0F\\u51FA\\u6B20\\u7BA1\\u7406\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SemesterSelector, {\n      semester: semester,\n      setSemester: setSemester\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TimetableGrid, {\n      lessons: lessons,\n      onEdit: openModalForEdit,\n      onAddAt: openModalAt,\n      onUpdate: updateLesson,\n      getIndicatorColor: getIndicatorColor\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(LessonFormModal, {\n      isOpen: isModalOpen,\n      onClose: () => setIsModalOpen(false),\n      onAdd: handleAddOrUpdate,\n      editLesson: editLesson,\n      newLocation: newLocation,\n      onDelete: removeLesson\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"p8rXxkf8YQnjWDcqaC6Z7kVjhS0=\", false, function () {\n  return [useTimetable];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useTimetable","SemesterSelector","TimetableGrid","LessonFormModal","jsxDEV","_jsxDEV","App","_s","semester","setSemester","saved","localStorage","getItem","setItem","lessons","addLesson","updateLesson","removeLesson","getIndicatorColor","isModalOpen","setIsModalOpen","editLesson","setEditLesson","newLocation","setNewLocation","openModalAt","weekday","period","openModalForEdit","lesson","handleAddOrUpdate","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onEdit","onAddAt","onUpdate","isOpen","onClose","onAdd","onDelete","_c","$RefreshReg$"],"sources":["/Users/wangzhenfei/Projects/attendance-timetable-web/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useTimetable } from './hooks/useTimetable';\nimport { SemesterSelector } from './components/SemesterSelector';\nimport { TimetableGrid } from './components/TimetableGrid';\nimport { LessonFormModal } from './components/LessonFormModal';\nimport { Semester, Lesson } from './types';\nimport './App.css';\n\nconst App: React.FC = () => {\n  // 学期持久化：从 localStorage 初始化，并在变更时写回\n  const [semester, setSemester] = useState<Semester>(() => {\n    const saved = localStorage.getItem('selectedSemester');\n    return (saved as Semester) || '2025 前期';\n  });\n  useEffect(() => {\n    localStorage.setItem('selectedSemester', semester);\n  }, [semester]);\n\n  // 将当前学期传给 Hook，按学期加载/保存课程\n  const {\n    lessons,\n    addLesson,\n    updateLesson,\n    removeLesson,\n    getIndicatorColor,\n  } = useTimetable(semester);\n\n  // 弹窗相关状态\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editLesson, setEditLesson] = useState<Lesson | null>(null);\n  const [newLocation, setNewLocation] = useState<{ weekday: number; period: number } | null>(null);\n\n  // 点击空白格子：打开“新增课程”弹窗\n  const openModalAt = (weekday: number, period: number) => {\n    setEditLesson(null);\n    setNewLocation({ weekday, period });\n    setIsModalOpen(true);\n  };\n\n  // 点击已有课程：打开“编辑课程”弹窗\n  const openModalForEdit = (lesson: Lesson) => {\n    setNewLocation(null);\n    setEditLesson(lesson);\n    setIsModalOpen(true);\n  };\n\n  // 弹窗提交后的处理：新增或更新\n  const handleAddOrUpdate = (lesson: Lesson) => {\n    if (editLesson) {\n      updateLesson(lesson);\n    } else {\n      addLesson(lesson);\n    }\n    setIsModalOpen(false);\n  };\n\n  return (\n    <div className=\"App\">\n      <h1>時間割／出欠管理</h1>\n\n      {/* 学期选择器 */}\n      <SemesterSelector semester={semester} setSemester={setSemester} />\n\n      {/* 课程表格：支持点击空格添加、点击课程编辑、±修改缺席 */}\n      <TimetableGrid\n        lessons={lessons}\n        onEdit={openModalForEdit}\n        onAddAt={openModalAt}\n        onUpdate={updateLesson}\n        getIndicatorColor={getIndicatorColor}\n      />\n\n      {/* 新增/编辑 弹窗：包含删除功能 */}\n      <LessonFormModal\n        isOpen={isModalOpen}\n        onClose={() => setIsModalOpen(false)}\n        onAdd={handleAddOrUpdate}\n        editLesson={editLesson}\n        newLocation={newLocation}\n        onDelete={removeLesson}\n      />\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}