{"ast":null,"code":"var _jsxFileName = \"/Users/wangzhenfei/Projects/attendance-timetable-web/src/App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useTimetable } from './hooks/useTimetable';\nimport { SemesterSelector } from './components/SemesterSelector';\nimport { TimetableGrid } from './components/TimetableGrid';\nimport { LessonFormModal } from './components/LessonFormModal';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  // 学期持久化（从 localStorage 初始化，并在变更时写入）\n  const [semester, setSemester] = useState(() => {\n    const saved = localStorage.getItem('selectedSemester');\n    return saved || '2025 前期';\n  });\n  useEffect(() => {\n    localStorage.setItem('selectedSemester', semester);\n  }, [semester]);\n  const {\n    lessons,\n    addLesson,\n    updateLesson,\n    getIndicatorColor\n  } = useTimetable();\n\n  // Modal 相关状态\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editLesson, setEditLesson] = useState(null);\n  const [newLocation, setNewLocation] = useState(null);\n\n  // 点击表格空格子：添加新课程\n  const openModalAt = (weekday, period) => {\n    setEditLesson(null);\n    setNewLocation({\n      weekday,\n      period\n    });\n    setIsModalOpen(true);\n  };\n\n  // 点击已有课程：编辑\n  const openModalForEdit = lesson => {\n    setNewLocation(null);\n    setEditLesson(lesson);\n    setIsModalOpen(true);\n  };\n\n  // 提交新增或更新\n  const handleAddOrUpdate = lesson => {\n    if (editLesson) updateLesson(lesson);else addLesson(lesson);\n    setIsModalOpen(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\u6642\\u9593\\u5272\\uFF0F\\u51FA\\u6B20\\u7BA1\\u7406\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SemesterSelector, {\n      semester: semester,\n      setSemester: setSemester\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TimetableGrid, {\n      lessons: lessons,\n      onEdit: openModalForEdit,\n      onAddAt: openModalAt,\n      onUpdate: updateLesson,\n      getIndicatorColor: getIndicatorColor\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(LessonFormModal, {\n      isOpen: isModalOpen,\n      onClose: () => setIsModalOpen(false),\n      onAdd: handleAddOrUpdate,\n      editLesson: editLesson,\n      newLocation: newLocation\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"K2IUphHRe09H5yVuiPRESRG9vjw=\", false, function () {\n  return [useTimetable];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useTimetable","SemesterSelector","TimetableGrid","LessonFormModal","jsxDEV","_jsxDEV","App","_s","semester","setSemester","saved","localStorage","getItem","setItem","lessons","addLesson","updateLesson","getIndicatorColor","isModalOpen","setIsModalOpen","editLesson","setEditLesson","newLocation","setNewLocation","openModalAt","weekday","period","openModalForEdit","lesson","handleAddOrUpdate","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onEdit","onAddAt","onUpdate","isOpen","onClose","onAdd","_c","$RefreshReg$"],"sources":["/Users/wangzhenfei/Projects/attendance-timetable-web/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useTimetable } from './hooks/useTimetable';\nimport { SemesterSelector } from './components/SemesterSelector';\nimport { TimetableGrid }    from './components/TimetableGrid';\nimport { LessonFormModal }  from './components/LessonFormModal';\nimport { Semester, Lesson } from './types';\nimport './App.css';\n\nconst App: React.FC = () => {\n  // 学期持久化（从 localStorage 初始化，并在变更时写入）\n  const [semester, setSemester] = useState<Semester>(() => {\n    const saved = localStorage.getItem('selectedSemester');\n    return (saved as Semester) || '2025 前期';\n  });\n  useEffect(() => {\n    localStorage.setItem('selectedSemester', semester);\n  }, [semester]);\n\n  const {\n    lessons,\n    addLesson,\n    updateLesson,\n    getIndicatorColor,\n  } = useTimetable();\n\n  // Modal 相关状态\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editLesson, setEditLesson]   = useState<Lesson | null>(null);\n  const [newLocation, setNewLocation] = useState<{ weekday: number; period: number } | null>(null);\n\n  // 点击表格空格子：添加新课程\n  const openModalAt = (weekday: number, period: number) => {\n    setEditLesson(null);\n    setNewLocation({ weekday, period });\n    setIsModalOpen(true);\n  };\n\n  // 点击已有课程：编辑\n  const openModalForEdit = (lesson: Lesson) => {\n    setNewLocation(null);\n    setEditLesson(lesson);\n    setIsModalOpen(true);\n  };\n\n  // 提交新增或更新\n  const handleAddOrUpdate = (lesson: Lesson) => {\n    if (editLesson) updateLesson(lesson);\n    else addLesson(lesson);\n    setIsModalOpen(false);\n  };\n\n  return (\n    <div className=\"App\">\n      <h1>時間割／出欠管理</h1>\n      {/* 学期选择器 */}\n      <SemesterSelector semester={semester} setSemester={setSemester} />\n\n      {/* 时间表格：支持点击空格添加、点击已有课程编辑、出欠修改 */}\n      <TimetableGrid\n        lessons={lessons}\n        onEdit={openModalForEdit}\n        onAddAt={openModalAt}\n        onUpdate={updateLesson}\n        getIndicatorColor={getIndicatorColor}\n      />\n\n      {/* 科目表单弹窗：新增或编辑 */}\n      <LessonFormModal\n        isOpen={isModalOpen}\n        onClose={() => setIsModalOpen(false)}\n        onAdd={handleAddOrUpdate}\n        editLesson={editLesson}\n        newLocation={newLocation}\n      />\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,YAAY,QAAQ,sBAAsB;AACnD,SAASC,gBAAgB,QAAQ,+BAA+B;AAChE,SAASC,aAAa,QAAW,4BAA4B;AAC7D,SAASC,eAAe,QAAS,8BAA8B;AAE/D,OAAO,WAAW;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnB,MAAMC,GAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC1B;EACA,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGX,QAAQ,CAAW,MAAM;IACvD,MAAMY,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,kBAAkB,CAAC;IACtD,OAAQF,KAAK,IAAiB,SAAS;EACzC,CAAC,CAAC;EACFX,SAAS,CAAC,MAAM;IACdY,YAAY,CAACE,OAAO,CAAC,kBAAkB,EAAEL,QAAQ,CAAC;EACpD,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;EAEd,MAAM;IACJM,OAAO;IACPC,SAAS;IACTC,YAAY;IACZC;EACF,CAAC,GAAGjB,YAAY,CAAC,CAAC;;EAElB;EACA,MAAM,CAACkB,WAAW,EAAEC,cAAc,CAAC,GAAGrB,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACsB,UAAU,EAAEC,aAAa,CAAC,GAAKvB,QAAQ,CAAgB,IAAI,CAAC;EACnE,MAAM,CAACwB,WAAW,EAAEC,cAAc,CAAC,GAAGzB,QAAQ,CAA6C,IAAI,CAAC;;EAEhG;EACA,MAAM0B,WAAW,GAAGA,CAACC,OAAe,EAAEC,MAAc,KAAK;IACvDL,aAAa,CAAC,IAAI,CAAC;IACnBE,cAAc,CAAC;MAAEE,OAAO;MAAEC;IAAO,CAAC,CAAC;IACnCP,cAAc,CAAC,IAAI,CAAC;EACtB,CAAC;;EAED;EACA,MAAMQ,gBAAgB,GAAIC,MAAc,IAAK;IAC3CL,cAAc,CAAC,IAAI,CAAC;IACpBF,aAAa,CAACO,MAAM,CAAC;IACrBT,cAAc,CAAC,IAAI,CAAC;EACtB,CAAC;;EAED;EACA,MAAMU,iBAAiB,GAAID,MAAc,IAAK;IAC5C,IAAIR,UAAU,EAAEJ,YAAY,CAACY,MAAM,CAAC,CAAC,KAChCb,SAAS,CAACa,MAAM,CAAC;IACtBT,cAAc,CAAC,KAAK,CAAC;EACvB,CAAC;EAED,oBACEd,OAAA;IAAKyB,SAAS,EAAC,KAAK;IAAAC,QAAA,gBAClB1B,OAAA;MAAA0B,QAAA,EAAI;IAAQ;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAEjB9B,OAAA,CAACJ,gBAAgB;MAACO,QAAQ,EAAEA,QAAS;MAACC,WAAW,EAAEA;IAAY;MAAAuB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAGlE9B,OAAA,CAACH,aAAa;MACZY,OAAO,EAAEA,OAAQ;MACjBsB,MAAM,EAAET,gBAAiB;MACzBU,OAAO,EAAEb,WAAY;MACrBc,QAAQ,EAAEtB,YAAa;MACvBC,iBAAiB,EAAEA;IAAkB;MAAAe,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtC,CAAC,eAGF9B,OAAA,CAACF,eAAe;MACdoC,MAAM,EAAErB,WAAY;MACpBsB,OAAO,EAAEA,CAAA,KAAMrB,cAAc,CAAC,KAAK,CAAE;MACrCsB,KAAK,EAAEZ,iBAAkB;MACzBT,UAAU,EAAEA,UAAW;MACvBE,WAAW,EAAEA;IAAY;MAAAU,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC1B,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV,CAAC;AAAC5B,EAAA,CApEID,GAAa;EAAA,QAebN,YAAY;AAAA;AAAA0C,EAAA,GAfZpC,GAAa;AAsEnB,eAAeA,GAAG;AAAC,IAAAoC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}